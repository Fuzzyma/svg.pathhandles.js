/*! svg.pathhandles.js - v0.0.1 - 2016-04-14
* https://github.com/Fuzzyma/svg.pathhandles.js
* Copyright (c) 2016 Ulrich-Matthias SchÃ¤fer; Licensed MIT */
!function(a,b){function c(b,c,d,e){return"C"!==c[0]?this:(this.cl1=d.parent.line(b[0],b[1],c[1],c[2]).stroke("#fff"),this.cl2=d.parent.line(c[3],c[4],c[5],c[6]).stroke("#fff"),this.cp1=d.parent.circle(10).center(c[1],c[2]).stroke("#fff").fill("none").draggable().style("pointer-events","all"),this.cp2=d.parent.circle(10).center(c[3],c[4]).stroke("#fff").fill("none").draggable().style("pointer-events","all"),e&&"C"!==d.el.array().valueOf()[e-1][0]&&(this.p1=d.parent.circle(10).center(b[0],b[1]).stroke("#fff").fill("none").draggable().style("pointer-events","all")),this.p2=d.parent.circle(10).center(c[5],c[6]).stroke("#fff").fill("none").draggable().style("pointer-events","all"),void new a.Set([this.p1,this.cp1,this.cp2,this.p2]).on("dragmove._handles",function(){d.update(e,this.p1?[this.p1.cx(),this.p1.cy()]:null,[this.cp1.cx(),this.cp1.cy()],[this.cp2.cx(),this.cp2.cy()],[this.p2.cx(),this.p2.cy()])},this))}function d(a){this.el=a,this.parent=a.parent(),a.remember("_handlesHandler",this),this.handles=[]}c.prototype.redraw=function(a,b){return"C"!==b[0]?this:(this.cl1.plot(a[0],a[1],b[1],b[2]),void this.cl2.plot(b[3],b[4],b[5],b[6]))},d.prototype.init=function(a,d){var e,f;this.options={},this.value=a;for(e in this.el.handles.defaults)this.options[e]=this.el.handles.defaults[e],d[e]!==b&&(this.options[e]=d[e]);var g,h=this.el.array().valueOf();for(e=0,f=h.length;f>e;++e)e&&(g=[h[e-1][h[e-1].length-2],h[e-1][h[e-1].length-1]]),this.handles.push(new c(g,h[e],this,e));this.observe()},d.prototype.handler=function(){if(this.value){var a=this.el.array().valueOf();this.handles.forEach(function(b,c){var d;c&&(d=[a[c-1][a[c-1].length-2],a[c-1][a[c-1].length-1]]),b.redraw(d,a[c])})}},d.prototype.observe=function(){var a=this;if(MutationObserver)if(this.value)this.observerInst=this.observerInst||new MutationObserver(function(){a.handler()}),this.observerInst.observe(this.el.node,{attributes:!0});else try{this.observerInst.disconnect(),delete this.observerInst}catch(b){}else this.el.off("DOMAttrModified.select"),this.value&&this.el.on("DOMAttrModified.select",function(){a.handler()})},d.prototype.update=function(a,b,c,d,e){var f=this.el.array().valueOf();a&&b&&(f[a-1][f[a-1].length-2]=b[0],f[a-1][f[a-1].length-1]=b[1]),f[a][1]=c[0],f[a][2]=c[1],f[a][3]=d[0],f[a][4]=d[1],f[a][5]=e[0],f[a][6]=e[1],this.el.plot(f)},a.extend(a.Path,{handles:function(a,c){"object"==typeof a&&(c=a,a=!0);var e=this.remember("_handlesHandler")||new d(this);return e.init(a===b?!0:a,c||{}),this}}),a.Element.prototype.selectize.defaults={points:!0,classRect:"svg_select_boundingRect",classPoints:"svg_select_points",radius:7,rotationPoint:!0,deepSelect:!1}}(SVG);